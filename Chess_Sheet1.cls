VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Private Sub Worksheet_SelectionChange(ByVal target As Range)

Dim Turn_W As Boolean 'Trueが白のターン'
Dim Piece_Select As Boolean 'Trueが駒を選択した状態'

'Turn_W = True'
'Piece_Select = False'

Dim Turn As Range 'どっちのターンか表示するセル
Dim Piece As Range 'どの駒を選択中か表示するセル
Set Turn = Range("K2")
Set Piece = Range("K3")

Dim Piece_Color_W As Long
Dim Piece_Color_B As Long
Piece_Color_W = RGB(255, 255, 255) '白
Piece_Color_B = RGB(0, 0, 0) '黒

Dim SelectInterior_Color As Long '移動可能範囲の色
SelectInterior_Color = RGB(155, 194, 230) '水色

Dim i, j As Integer

'ターンの判別'
If Turn.Value = "白" Then
 Turn_W = True
End If

'駒かどうか判別
If Turn_W And Not target.Value = "" And target.Font.Color = Piece_Color_W Then
 Piece_Select = True
ElseIf Not Turn_W And Not target.Value = "" And target.Font.Color = Piece_Color_B Then
 Piece_Select = True
Else
 Piece_Select = False
End If

If Piece_Select Then '駒の場合
    If Turn_W Then '白のターン
        If Not Piece.Value = "" Then
            Call 背景色初期化
        End If
        If target.Value = "歩" And target.Font.Color = Piece_Color_W Then
                Call 白のポーン(target, Piece_Color_W, Piece_Color_B, SelectInterior_Color)
            Piece.Value = target.Address
        End If
    Else '黒のターン(のちほど)

    End If
    Piece_Select = False
Else '駒ではない場合
    If Not Piece.Value = "" Then
        If target.Interior.Color = SelectInterior_Color Then
            target.Value = Range(Piece.Value)
            target.Font.Color = Range(Piece.Value).Font.Color
            Range(Piece.Value).Value = ""
            Piece.Value = ""
        End If
        Call 背景色初期化
        Piece_Select = True
        Piece.Value = ""
    End If
End If
End Sub
